from random import choice

import telebot
from telebot import types

token = '5363826534:AAHPat049P4CGg7H8vAtucRrRusXa7X_vy4'

bot = telebot.TeleBot(token)


RANDOM_TASKS = ['—Å–ø–æ—Ä—Ç–∏—Ç—å', '–Ω–µ —Å–ø–æ—Ä—Ç–∏—Ç—å']

tasks = {
    }


HELP = '''
–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —ç—Ç–æ—Ç –±–æ—Ç - –ø–ª–∞–Ω–µ—Ä –∏ –≤–æ—Ç —á—Ç–æ –æ–Ω —É–º–µ–µ—Ç:
‚ú® /todo, /add - –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é –¥–∞—Ç—É, –Ω–∞–ø—Ä–∏–º–µ—Ä, "/add 01.01.2023 –Ω–µ –ø—Ä–æ—Å–ø–∞—Ç—å –Ω–æ–≤—ã–π –≥–æ–¥"
‚ú® /print, /show  - –Ω–∞–ø–µ—á–∞—Ç—å –≤—Å–µ –∑–∞–¥–∞—á–∏ –Ω–∞ –∑–∞–¥–∞–Ω–Ω—É—é –¥–∞—Ç—É, –Ω–∞–ø—Ä–∏–º–µ—Ä, "/show 01.01.2023"
‚ú® /random - –¥–∞–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç –∑–∞–Ω–∏–º–∞—Ç—å—Å—è —Ç–µ–±–µ —Å–ø–æ—Ä—Ç–æ–º —Å–µ–≥–æ–¥–Ω—è –∏–ª–∏ –Ω–µ—Ç –∏ –¥–æ–±–∞–≤–∏—Ç –¥–∞–Ω–Ω—É—é –∑–∞–¥–∞—á—É –Ω–∞ –¥–∞—Ç—É "—Å–µ–≥–æ–¥–Ω—è"
‚ú® /help - –ù–∞–ø–µ—á–∞—Ç–∞—Ç—å help
P.S. "—Å–µ–≥–æ–¥–Ω—è" - —ç—Ç–æ —Ç–æ–∂–µ –¥–∞—Ç–∞, –º–æ–∂–µ—à—å –µ–µ —Ö–æ—Ç—å –∫–∞–ø—Å–æ–º –Ω–∞–ø–µ—á–∞—Ç–∞—Ç—å, –æ–Ω —Ç–µ–±—è –ø–æ–π–º–µ—Ç –∏ –Ω–∞–ø–∏—à–µ—Ç –Ω–∞ –°–µ–ì–æ–î–Ω–Ø —Ç–≤–æ—é –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É
'''


def add_todo(date, task):
    date = date.lower()
    if date in tasks:
        tasks[date].append(task)
    else:
        tasks[date] = []
        tasks[date].append(task)




@bot.message_handler(commands=['start'])
def start(message):
    markup = types.ReplyKeyboardMarkup(resize_keyboard = True)
    item1 = types.KeyboardButton('–ó–∞–ø–∏—Å–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ')
    item2 = types.KeyboardButton('–ü–æ–∫–∞–∑–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ')
    item3 = types.KeyboardButton('–°–ø–æ—Ä—Ç - —ç—Ç–æ –∂–∏–∑–Ω—å')
    item4 = types.KeyboardButton('–ø–æ–º–æ–≥–∏—Ç–µ')

    markup.add(item1, item2, item3, item4)

    bot.send_message(message.chat.id, '–ü—Ä–∏–≤–µ—Ç, {0.first_name}!'.format(message.from_user), reply_markup = markup)


@bot.message_handler(commands=['help'])
def help(message):
    bot.send_message(message.chat.id, HELP)


@bot.message_handler(commands=['random'])
def random(message):
    task = choice(RANDOM_TASKS)
    add_todo('—Å–µ–≥–æ–¥–Ω—è', task)
    bot.send_message(message.chat.id, f'–ó–∞–¥–∞—á–∞ {task} –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è')


@bot.message_handler(commands=['add', 'todo'])
def add(message):
    command = message.text.split(maxsplit=2)
    task = command[2]
    date = command[1]
    add_todo(date, task)
    bot.send_message(message.chat.id, f'–ó–∞–¥–∞—á–∞ {task} –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞ –¥–∞—Ç—É {date}')


@bot.message_handler(commands=['show', 'print'])
def show(message):
    command = message.text.split(maxsplit = 1)
    date = command[1].lower()
    text = ''
    if date in tasks:
        text = date.upper() + '\n'
        for task in tasks[date]:
            text += f'üöΩ {task}\n'
    else:
        text = '–¢–∞–∫–æ–π –¥–∞—Ç—ã –Ω–µ—Ç'
    bot.send_message(message.chat.id, text)

@bot.message_handler(content_types=['text'])
def echo(message):
    if message.text == "–ø–æ–º–æ–≥–∏—Ç–µ":
        help(message)
    elif message.text == "–°–ø–æ—Ä—Ç - —ç—Ç–æ –∂–∏–∑–Ω—å":
        random(message)
    elif message.text == "–ó–∞–ø–∏—Å–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ":
        bot.send_message(message.chat.id, '–û—Ñ–æ—Ä–º–∏ —Å–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º: "/add 01.01.2023 –Ω–µ –ø—Ä–æ—Å–ø–∞—Ç—å –Ω–æ–≤—ã–π –≥–æ–¥"')
    elif message.text == "–ü–æ–∫–∞–∑–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ":
        bot.send_message(message.chat.id, '–û—Ñ–æ—Ä–º–∏ —Å–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º: "/show 01.01.2023"')
    else:
        text = '–°–∞–º —Ç—ã ' + message.text.upper() + '!!!'
        bot.send_message(message.chat.id, text)

bot.polling(none_stop=True)
